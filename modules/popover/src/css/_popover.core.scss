@import "@pluginjs/styles/variables.scss";

// Vars
// =====================
$popover: "pj-popover" !default;
$popover-font-family: $font-family-base !default;
$popover-font-size: $font-size-sm !default;
$popover-max-width: 20.42 * $popover-font-size !default;
$popover-max-height: 50vh !default;
$popover-color: $text-color !default;
$popover-zindex: $zindex-popover !default;
$popover-bg: #fff !default;
$popover-border-width: 1px !default;
$popover-opacity: 0.9 !default;
$popover-border-color: $border-color !default;
$popover-border-radius: $border-radius-base !default;
$popover-box-shadow: 0 5px 20px 0 
rgba(0, 0, 0, 0.1) !default;
$popover-margin-spacer: 1.42 * $popover-font-size !default;
$popover-close-spacer-y: 0.71  * $popover-font-size !default;
$popover-close-spacer-x: 0.71  * $popover-font-size !default;
$popover-spacer-x: 1.714 * $popover-font-size !default;
$popover-spacer-y: 1.33 * $popover-font-size !default;
$popover-close-font-size: $font-size-lg !default;
$popover-close-color: $gray-dark !default;
$popover-close-line-height: 1em !default;
$popover-title-spacer: $popover-spacer-y $popover-spacer-x 0 $popover-spacer-x !default;
$popover-content-margin-top: 0.7 * $popover-font-size !default;
$popover-title-font-size: $font-size-lg !default;
$popover-title-line-height: 1.5em !default;
$popover-content-spacer: 0 $popover-spacer-x !default;
$popover-arrow-width: 0.71  * $popover-font-size !default;
$popover-arrow-color: $popover-bg !default;
$popover-arrow-outer-width: ($popover-arrow-width + 1px) !default;
$popover-arrow-outer-color: $popover-bg !default;
$popover-arrow-offset-x: 0.71  * $popover-font-size !default;
$popover-arrow-offset-y: 0.71  * $popover-font-size !default;

$popover-btn-padding-y: 0.893 * $popover-font-size !default;
$popover-btn-padding-x: 2.15 * $popover-font-size !default;

@mixin reset-text {
  font-family: $font-family-base;
  // We deliberately do NOT reset font-size or word-wrap.
  font-style: normal;
  font-weight: $font-weight-normal;
  line-height: $line-height-base;
  // text-align: left; // Fallback for where `start` is not supported
  text-align: start;
  text-decoration: none;
  text-shadow: none;
  text-transform: none;
  letter-spacing: normal;
  word-break: normal;
  word-spacing: normal;
  white-space: normal;
  line-break: auto;
}

// Core
// =====================
.#{$popover} {
  @include reset-text();

  position: absolute;
  left: 0;
  z-index: $popover-zindex;
  display: block;
  max-width: $popover-max-width;
  margin-bottom: $popover-margin-spacer;
  font-family: $popover-font-family;
  font-size: $popover-font-size;
  color: $popover-color;
  // Allow breaking very long words so they don't overflow the popover's bounds
  word-wrap: break-word;
  background-color: $popover-bg;
  background-clip: padding-box;
  border-radius: $popover-border-radius;
  box-shadow: $popover-box-shadow;
  opacity: 0;

  h3 {
    margin-top: 0;
  }

  &.#{$popover}-show {
    opacity: $popover-opacity;
  }

  &::before,
  &::after {
    position: absolute;
    display: block;
    width: 0;
    height: 0;
    pointer-events: none;
    border-color: transparent;
    border-style: solid;
  }

  &-btn {
    padding: $popover-btn-padding-y $popover-btn-padding-x;
    font-size: $popover-font-size;
  }
}

*[x-placement="bottom"],
*[x-placement="bottom-start"],
*[x-placement="bottom-end"] {
  margin: 0;
  margin-top: $popover-margin-spacer;
}

*[x-placement="left"],
*[x-placement="left-start"],
*[x-placement="left-end"] {
  margin: 0;
  margin-right: $popover-margin-spacer;
}

*[x-placement="right"],
*[x-placement="right-start"],
*[x-placement="right-end"] {
  margin: 0;
  margin-left: $popover-margin-spacer;
}

// Offset the popover to account for the popover arrow
.#{$popover}-content {
  max-height: $popover-max-height;
  padding: $popover-content-spacer;
  margin: $popover-content-margin-top 0 $popover-spacer-y;
  overflow: auto;
}

.#{$popover}-title {
  padding: $popover-title-spacer;
  margin-bottom: 0;
  font-size: $popover-title-font-size;
  line-height: $popover-title-line-height;

  & + .#{$popover}-content:empty {
    margin-top: 0;
  }

  &:empty {
    display: none;
  }

  &:empty + .#{$popover}-content {
    padding-top: $popover-spacer-y;
    margin-top: 0;
  }
}


.#{$popover}-button {
  font-size: $popover-font-size;
}

// Close
.#{$popover}-close {
  position: absolute;
  top: 0;
  right: 0;
  z-index: 1;
  padding: $popover-close-spacer-y $popover-close-spacer-x;
  font-size: $popover-close-font-size;
  line-height: $popover-close-line-height;
  color: $popover-close-color;
  text-decoration: none;
  background: transparent;
  border: 0;
  outline: 0;
  opacity: 0.5;
  appearance: none;
  // -webkit-appearance: none;

  &:hover {
    cursor: pointer;
    opacity: 0.9;
  }

  // &::before {
  //   font-size: 1em;
  //   content: "\00d7";
  // }
  &:not(:disabled):hover {
    background: initial;
  }
}

// Animation
.#{$popover}-fade {
  opacity: 0;
  transition: opacity 0.15s linear;

  &.#{$popover}-show {
    opacity: 1;
  }
}
